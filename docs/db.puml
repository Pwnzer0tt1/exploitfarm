@startuml er-schema

hide circle


entity "**Env**" as env {
    key: string
    --
    value: string
}

entity "**Exploit**" as exploit{
    id : number
    --
    name: string
    language: string [enum]
    hash: string
    cli: boolean
    status: string [enum]
    created_at: date
}

entity "**Flag**" as flag{
    id: number
    --
    flag: string [unique]
    status: string [enum] [indexed]
    last_submission_at: date [nullable] [indexed]
    status_text: string [nullable]
    submit_attempts: int
}

entity "**Attack-Execution**" as attack{
    id: number
    --
    start_time: date
    end_time: date
    status: string [enum]
    error: string [nullable]
    output: string [compressed, nullable]
    received_at: date
}

entity "**Client**" as client{
    id: number
    --
    name: string
    address: string
}

entity "**Service**" as service{
    id : number
    --
    name: string
}

entity "**Team**" as team{
    id : number
    --
    name: string [optional]
    short_name: string [optional]
    address: string
    created_at: string
}

entity "**Submitter**" as submitter{
    id: number
    --
    name: string
    code: string
    kargs: array 
}

entity "**Exploit-Source**" as exploit_source{
    hash: string
    --
    pushed_at: date
    os: string
    distro: string
    arch: string
}

entity "**Attack-Group**" as attack_group{
    id: number
    --
    name: string
    last_attack: date
    created_at: date
}
    

service ||--o{ exploit
team ||--o{ attack
client ||--o{ exploit
client ||--o{ attack
exploit ||--o{ attack
attack ||--o{ flag
exploit ||--o{ exploit_source
attack_group ||--o{ attack
exploit ||--o{ attack_group
client }|--o{ attack_group
attack }o--o| exploit_source
exploit_source }o--o| client

@enduml