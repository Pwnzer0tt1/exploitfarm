import { hashedColor } from "@/utils"
import { exploitsQuery, statusQuery, useExtendedExploitSolver } from "@/utils/queries"
import { Box, Divider, Flex, Paper, ScrollArea, Space, Tooltip } from "@mantine/core"
import { GoDotFill } from "react-icons/go"


export const ExploitBar = () => {
    const exploits = exploitsQuery()
    const extendedExploitSolver = useExtendedExploitSolver()
    const status = statusQuery()
    const base_secret = status.data?.config?.SERVER_ID??"_"

    return <Box style={{width:"100%", fontSize:"90%"}} >
        <b>Launched Exploits</b>
        <Space h="md" />
        <Divider />
        <Space h="lg" />
        <ScrollArea style={{width:"100%"}}>
            <Flex>
                {(exploits.data??[]).sort( (expl) => expl.status=="disabled"?-1:1 ).map((expl) => <Box>
                    <Box style={{fontSize:"90%"}}>
                        <Paper shadow="md" radius="xl" withBorder px={20} py={5} bg="gray" mx="xs">
                            <Box className="center-flex">
                                <Tooltip label={expl.status=="active"?"Active":"Inactive"} color={expl.status=="active"?"green":"red"}>
                                    <span className="center-flex"><GoDotFill color={expl.status=="active"?"green":"red"} size={30} /></span>
                                </Tooltip>
                                <Space w={3} />
                                <Box color={hashedColor(base_secret+expl.id)}>
                                    {extendedExploitSolver(expl.id)}
                                </Box>
                            </Box>
                        </Paper>
                        
                    </Box>
                    <Space h="md" />
                    
                </Box>)}
            </Flex>
        </ScrollArea>
        
        <Space h="md" />
    </Box>
}